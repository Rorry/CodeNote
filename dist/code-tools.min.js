YUI.add("cn-css-inliner",function(a){var b=[{key:".hljs",value:"display: block; padding: 0.5em;color: #000;background: #fff;"},{key:".hljs-subst,.hljs-title",value:"font-weight: normal;color: #000;"},{key:".hljs-comment,.hljs-template_comment,.hljs-javadoc,.diff .hljs-header",value:"color: #808080;font-style: italic;"},{key:".hljs-annotation,.hljs-decorator,.hljs-preprocessor,.hljs-pragma,.hljs-doctype,.hljs-pi,.hljs-chunk,.hljs-shebang,.apache .hljs-cbracket,.hljs-prompt,.http .hljs-title",value:"color: #808000;"},{key:".hljs-tag,.hljs-pi",value:"background: #efefef;"},{key:".hljs-tag .hljs-title,.hljs-id,.hljs-attr_selector,.hljs-pseudo,.hljs-literal,.hljs-keyword,.hljs-hexcolor,.css .hljs-function,.ini .hljs-title,.css .hljs-class,.hljs-list .hljs-title,.clojure .hljs-title,.nginx .hljs-title,.tex .hljs-command,.hljs-request,.hljs-status",value:"font-weight: bold;color: #000080;"},{key:".hljs-attribute,.hljs-rules .hljs-keyword,.hljs-number,.hljs-date,.hljs-regexp,.tex .hljs-special",value:"font-weight: bold;color: #0000ff;"},{key:".hljs-number,.hljs-regexp",value:"font-weight: normal;"},{key:".hljs-string,.hljs-value,.hljs-filter .hljs-argument,.css .hljs-function .hljs-params,.apache .hljs-tag",value:"color: #008000;font-weight: bold;"},{key:".hljs-symbol,.ruby .hljs-symbol .hljs-string,.hljs-char,.tex .hljs-formula",value:"color: #000;background: #d0eded;font-style: italic;"},{key:".hljs-phpdoc,.hljs-yardoctag,.hljs-javadoctag",value:"text-decoration: underline;"},{key:".hljs-variable,.hljs-envvar,.apache .hljs-sqbracket,.nginx .hljs-built_in",value:"color: #660e7a;"},{key:".hljs-addition",value:"background: #baeeba;"},{key:".hljs-deletion",value:"background: #ffc8bd;"},{key:".diff .hljs-change",value:"background: #bccff9;"}];a.namespace("CN").CSSInliner=function(){var c=function(c){a.Array.each(b,function(a){c.all(a.key).each(function(b){var c=b.getAttribute("cn-style_")+a.value;b.setAttribute("cn-style_",c),b.removeAttribute("class"),b.removeAttribute("style")})})};return{toInline:c}}()},"1.0",{requires:[]}),YUI.add("cn-evernote-storage",function(a){var b="evernote_collections",c="oauth_token",d="notebooks",e="tags",f=3e5;a.namespace("CN.Evernote").Note=a.Base.create("cn-evernote-note",a.Base,[],{},{ATTRS:{guid:{value:null,validator:a.Lang.isString},title:{value:"",validator:a.Lang.isString},notebook:{value:null},tags:{value:[],validator:a.Lang.isArray},content:{value:null,validator:a.Lang.isString}}}),a.namespace("CN.Evernote").Storage=a.Base.create("cn-evernote-storage",a.Base,[],{_TEMPLATE_EN:'<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE en-note SYSTEM "http://xml.evernote.com/pub/enml2.dtd"><en-note>{content}</en-note>',_cache:null,_noteStoreURL:null,_authenticationToken:null,_noteStoreTransport:null,_noteStoreProtocol:null,_noteStore:null,_clearContent:function(a){return a=a.replace(/id="[\s|\w]*"/g,""),a=a.replace(/class="[\s|\w|-]*"/g,""),a=a.replace(/<td [\w|=|\"|\s]*">/g,"<td>"),a=a.replace(/<table [\w|=|\"|\s]*>/g,"<table>"),a=a.replace(/<br>/g,"</br>"),a=a.replace(/cn-style_/g,"style")},initializer:function(d){var e;this._noteStoreURL=d.noteStoreURL,this._authenticationToken=d.authenticationToken,this._noteStoreTransport=new Thrift.BinaryHttpTransport(this._noteStoreURL),this._noteStoreProtocol=new Thrift.BinaryProtocol(this._noteStoreTransport),this._noteStore=new NoteStoreClient(this._noteStoreProtocol),this.set("note",new a.CN.Evernote.Note),this._cache=new a.CacheOffline({sandbox:b,expires:f}),e=this._cache.retrieve(c),e&&e.response!=d.authenticationToken&&this._cache.flush()},clearNote:function(){this.set("note",new a.CN.Evernote.Note)},setNotebook:function(a){var b=this.get("note");b.set("notebook",a)},setTitle:function(a){var b=this.get("note");b.set("title",a)},addTag:function(a){var b=this.get("note");b.get("tags").push(a)},removeTag:function(a){var b=this.get("note"),c=b.get("tags"),d=c.indexOf(a);d>-1&&c.splice(d,1)},notebooksPromise:function(){var b=this;return new a.Promise(function(c,e){var f=b._cache.retrieve(d);f?c(f.response):b._noteStore.listNotebooks(b._authenticationToken,function(e){a.log(e),b._cache.add(d,e),c(e)},function(b){a.log(b),e(b)})})},tagsPromise:function(){var b=this;return new a.Promise(function(c,d){var f=b._cache.retrieve(e);f?c(f.response):b._noteStore.listTags(b._authenticationToken,function(d){a.log(d),b._cache.add(e,d),c(d)},function(b){a.log(b),d(b)})})},searchNotesPromise:function(b){var c=this;return new a.Promise(function(d,e){var f=new NoteFilter,g=new NotesMetadataResultSpec;f.words=b,f.inactive=!1,g.includeTitle=!0,c._noteStore.findNotesMetadata(c._authenticationToken,f,0,10,g,function(b){a.log(b),d(b.notes)},function(b){a.log(b),e(b)})})},setNotePromise:function(b){var c=this;return new a.Promise(function(d,e){var f;c._noteStore.getNote(c._authenticationToken,b,!0,!1,!1,!1,function(b){f=new a.CN.Evernote.Note({guid:b.guid,title:b.title,content:b.content}),c.set("note",f),d(b)},function(b){a.log(b),e(b)})})},savePromise:function(b){var c,d=this.get("note"),e=d.get("guid");return c=a.Lang.isString(e)&&e.length>0?this.updatePromise(b):this.createPromise(b)},updatePromise:function(b){var c=this;return new a.Promise(function(d,e){var f=c.get("note"),g=new Note,h=f.get("content").slice(0,-10);g.guid=f.get("guid"),g.title=f.get("title"),h+=c._clearContent(b)+"</en-note>",g.content=h,c._noteStore.updateNote(c._authenticationToken,g,function(a){d(a)},function(b){a.log(b),e(b)})})},createPromise:function(b){var c=this;return new a.Promise(function(d,e){var f,g=c.get("note"),h=new Note,i=g.get("title");h.notebookGuid=g.get("notebook"),h.title=i.length>0?i:"Untitled",h.tagGuids=g.get("tags"),f=a.Lang.sub(c._TEMPLATE_EN,{content:b}),f=c._clearContent(f),h.content=f,c._noteStore.createNote(c._authenticationToken,h,function(a){d(a)},function(b){a.log(b),e(b)})})}},{ATTRS:{note:{value:null}}})},"1.0",{requires:["base","promise","cache-offline"]}),YUI.add("cn-code-note-popup",function(a){var b=chrome.extension.getURL("resources/templates/popup.html"),c=chrome.extension.getURL("resources/templates/message.html"),d='<button class="btn btn-small btn-white btn-outline cn-tag">{tag}</button>';a.namespace("CN").Popup=a.Base.create("cn-code-note-popup",a.Base,[],{_panel:null,_select:null,_btnSave:null,_inputTitle:null,_inputSearch:null,_inputTags:null,_blockTags:null,_btnClear:null,_btnCancel:null,_informer:null,initializer:function(c){var d=this,e=c.callback;e&&d.set("callback",e),a.io(b,{on:{success:function(b,c){var f=a.one("html"),g=a.Node.create(c.responseText);d._panel=g,d._select=g.one("#cn-notebook"),d._btnSave=g.one("#cn-save-btn"),d._inputTitle=g.one("#cn-title"),d._inputSearch=g.one("#cn-search"),d._blockTags=g.one("#cn-selected-tags"),d._inputTags=g.one("#cn-tags"),d._btnClear=g.one("#cn-clear-search"),d._btnCancel=g.one("#cn-cancel-btn"),d._informer=new a.CN.Informer,g.hide(),f.appendChild(g),a.Lang.isFunction(e)&&d._btnCancel.on("click",function(){e()})}}})},initUI:function(b,c){var d,e=this,f=function(a){e._informer.showErrorMessage(a)};a.Lang.isValue(e._panel)&&a.Lang.isString(b.oauth_token)&&(d=new a.CN.Evernote.Storage({noteStoreURL:b.note_store_url,authenticationToken:b.oauth_token}),e._initTags(d),d.notebooksPromise().then(function(b){a.Array.each(b,function(b){var c=b.guid,f=b.name,g=a.Node.create(a.Lang.sub('<option value="{guid}">{name}</option>',{guid:c,name:f}));b.defaultNotebook&&(d.setNotebook(c),g.set("selected","selected")),e._select.appendChild(g)})},f),e._select.on("change",function(a){var b=a.target.get("value");d.setNotebook(b)}),e._inputSearch.plug(a.Plugin.AutoComplete,{resultHighlighter:"phraseMatch",resultTextLocator:"title",source:function(a,b){d.searchNotesPromise(a).then(b,f)},on:{select:function(a){var b=a.result.raw;d.setNotePromise(b.guid).then(function(a){e._inputTitle.set("value",a.title),e._inputTags.setAttribute("disabled","disabled"),e._select.setAttribute("disabled","disabled")},f)}}}),e._btnClear.on("click",function(){d.clearNote(),e._inputTitle.set("value",""),e._inputSearch.set("value",""),e._inputTags.removeAttribute("disabled"),e._select.removeAttribute("disabled")}),e._inputTitle.on("change",function(a){var b=a.target.get("value");d.setTitle(b)}),e._btnSave.on("click",function(){e._doSave(d,c)}))},_initTags:function(b){var c=this;b.tagsPromise().then(function(e){var f=[],g={};a.Array.each(e,function(a){f.push(a)}),c._inputTags.plug(a.Plugin.AutoComplete,{resultHighlighter:"phraseMatch",resultFilters:"phraseMatch",resultTextLocator:"name",source:function(a,b){var c,d=[];for(c=0;c<f.length;c++)f[c].guid in g||d.push(f[c]);b(d)},on:{select:function(e){var f=e.result.raw,h=a.Node.create(a.Lang.sub(d,{tag:f.name}));g[f.guid]=f.name,b.addTag(f.guid),c._blockTags.appendChild(h),h.on("click",function(){delete g[f.guid],b.removeTag(f.guid),c._blockTags.removeChild(this)},h)}}})},function(a){c._informer.showErrorMessage(a)})},_doSave:function(b,c){var d=this,e=this.get("callback"),f=c.filter(".cn-selected"),g=a.Node.create("<div></div>");f.each(function(b){var c=b.cloneNode(!0);a.CN.CSSInliner.toInline(c),c.removeAttribute("selected"),g.appendChild(c)}),d._informer.showLoadingMessage(),b.savePromise(g.getHTML()).then(function(b){a.log(b),d._informer.showOkMessage()},function(a){d._informer.showErrorMessage(a)}),a.Lang.isFunction(e)&&e()},show:function(){a.Lang.isValue(this._panel)&&this._panel.show()},hide:function(){a.Lang.isValue(this._panel)&&this._panel.hide()},reset:function(){a.Lang.isValue(this._panel)&&(this._select.removeAttribute("disabled"),this._select.empty(),this._inputSearch.set("value",""),this._inputSearch.unplug(a.Plugin.AutoComplete),this._inputSearch.detach(),this._inputTitle.set("value",""),this._inputTags.removeAttribute("disabled"),this._inputTags.set("value",""),this._inputTags.unplug(a.Plugin.AutoComplete),this._inputTags.detach(),this._blockTags.empty(),this._btnClear.detach(),this._btnSave.detach())}},{ATTRS:{callback:{value:null,validator:a.Lang.isFunction}}}),a.namespace("CN").Informer=a.Base.create("cn-code-note-informer",a.Base,[],{_panel:null,_messageContainer:null,_successIcon:null,_errorIcon:null,_loadingIcon:null,_hideMessage:function(){var b=this._panel;a.later(3e3,this,function(){var c=new a.Anim({node:b,duration:2,to:{opacity:0},after:{end:function(){b.hide(),b.setStyle("opacity",1)}}});c.run()})},initializer:function(){var b=this;a.io(c,{on:{success:function(c,d){var e=a.one("html"),f=a.Node.create(d.responseText);b._panel=f,b._messageContainer=f.one("#cn-message"),b._successIcon=f.one("#cn-success-icon"),b._errorIcon=f.one("#cn-error-icon"),b._loadingIcon=f.one("#cn-loading-icon"),f.hide(),e.appendChild(f)}}})},showOkMessage:function(){a.Lang.isValue(this._panel)&&(this._messageContainer.set("text","Success!"),this._successIcon.show(),this._errorIcon.hide(),this._loadingIcon.hide(),this._panel.show(),this._hideMessage())},showErrorMessage:function(){a.Lang.isValue(this._panel)&&(this._messageContainer.set("text","Error!"),this._successIcon.hide(),this._errorIcon.show(),this._loadingIcon.hide(),this._panel.show(),this._hideMessage())},showLoadingMessage:function(){a.Lang.isValue(this._panel)&&(this._messageContainer.set("text","Loading..."),this._successIcon.hide(),this._errorIcon.hide(),this._loadingIcon.show(),this._panel.show())}},{ATTRS:{}})},"1.0",{requires:["node","anim-base","io-base","autocomplete","autocomplete-highlighters","autocomplete-filters","cn-evernote-storage","cn-css-inliner"]}),YUI.add("cn-code-cleaner",function(a){a.namespace("CN").CodeCleaner=a.Base.create("cn-code-cleaner",a.Base,[],{extractsSourceSpans:function(a,b){function c(a){var i=a.nodeType;if(1==i){if(d.test(a.className))return;for(var j=a.firstChild;j;j=j.nextSibling)c(j);var k=a.nodeName.toLowerCase();("br"===k||"li"===k)&&(e[h]="\n",g[h<<1]=f++,g[h++<<1|1]=a)}else if(3==i||4==i){var l=a.nodeValue;l.length&&(l=b?l.replace(/\r\n?/g,"\n"):l.replace(/[ \t\r\n]+/g," "),e[h]=l,g[h<<1]=f,f+=l.length,g[h++<<1|1]=a)}}var d=/(?:^|\s)nocode(?:\s|$)/,e=[],f=0,g=[],h=0;return c(a),{sourceCode:e.join("").replace(/\n$/,""),spans:g}},process:function(a){var b=this.extractsSourceSpans(a._node,!0);a.set("text",b.sourceCode)}},{})},"1.0",{requires:["base","array-extras"]}),YUI.add("cn-languages",function(a){a.namespace("CN.Model").Language=a.Base.create("cn-model-language",a.Model,[],{getName:function(){return this.get("name")},getAliases:function(){return this.get("aliases")},getKeywords:function(){return this.get("keywords")}},{ATTRS:{name:{value:"",validator:a.Lang.isString,readonly:!0},aliases:{value:[],validator:a.Lang.isArray,readonly:!0},keywords:{value:[],validator:a.Lang.isArray,readonly:!0}}}),a.namespace("CN.Model.List").Language=a.Base.create("cn-model-list-language",a.ModelList,[],{model:a.CN.Model.Language})},"1.0",{requires:["model","model-list"]}),YUI.add("cn-lang-detector",function(a){a.namespace("CN").LangDetector=a.Base.create("cn-lang-detector",a.Base,[],{clean:function(a){var b,c,d,e="";for(b=0;b<a.length;b++)c=a.charAt(b),/[a-zA-Z0-9_]/.test(c)?(e+=c,d=!1):d||(e+=" ",d=!0);return e},freqTable:function(b){var c={},d=this.clean(b),e=d.split(/[\s]+/);return a.Array.each(e,function(a){var b=c[a]||0;c[a]=b+1}),c},compare:function(b,c){var d=0;return a.Object.each(b,function(a,b){c.indexOf(b)<0&&(d+=3*a)}),d},guess:function(b){var c,d=this,e="js",f=this.freqTable(b),g=this.getLanguages();return a.Array.each(g,function(a){var b=d.compare(f,a.keywords);c?c>b&&(c=b,e=a.name):(c=b,e=a.name)}),e},checkLang:function(a){var b=null,c=this.getLanguages();return c.each(function(c){var d=c.getAliases();d.indexOf(a)>=0&&(b=c.getName())}),b},checkNode:function(b){{var c,d=this,e=b&&b.getAttribute("lang")||null,f=b&&b.getAttribute("class")||null;this.getLanguages()}return a.Lang.isNull(e)?a.Lang.isNull(f)||(c=f.split(" "),a.Array.each(c,function(b){var c=d.checkLang(b);a.Lang.isNull(c)||(e=c)})):e=this.checkLang(e),e},check:function(b){var c=b,d=this.checkNode(c);return a.Lang.isNull(b)?null:(a.Lang.isNull(d)&&(c=b.get("parent"),c&&(d=this.checkNode(c))),a.Lang.isNull(d)&&(c=b.one("code"),c&&(d=this.checkNode(c))),d)},process:function(b){var c;a.Lang.isNull(b)||(c=this.check(b),c||(c=this.guess(b.get("text"))),b.setAttribute("lang",c))},getLanguages:function(){return this.get("languages")}},{ATTRS:{languages:{valueFn:function(){var b=new a.CN.Model.List.Language;return b.add(new a.CN.Model.Language({name:"applescript",aliases:["applescript"]})),b.add(new a.CN.Model.Language({name:"as3",aliases:["as3","actionscript3"]})),b.add(new a.CN.Model.Language({name:"bash",aliases:["bash","shell","sh"]})),b.add(new a.CN.Model.Language({name:"cf",aliases:["coldfusion","cf"]})),b.add(new a.CN.Model.Language({name:"cpp",aliases:["cpp","cc","c++","c","h","hpp","h++"]})),b.add(new a.CN.Model.Language({name:"csharp",aliases:["c#","c-sharp","csharp"]})),b.add(new a.CN.Model.Language({name:"css",aliases:["css"]})),b.add(new a.CN.Model.Language({name:"delphi",aliases:["delphi","pascal","pas"]})),b.add(new a.CN.Model.Language({name:"diff",aliases:["diff","patch"]})),b.add(new a.CN.Model.Language({name:"erlang",aliases:["erl","erlang"]})),b.add(new a.CN.Model.Language({name:"groovy",aliases:["groovy"]})),b.add(new a.CN.Model.Language({name:"haxe",aliases:["haxe","hx"]})),b.add(new a.CN.Model.Language({name:"java",aliases:["java"],keywords:["abstract","assert","boolean","break","byte","case","catch","char","class","const","continue","default","do","double","else","enum","extends","false","final","finally","float","for","goto","if","implements","import","instanceof","int","interface","long","native","new","null","package","private","protected","public","return","short","static","strictfp","super","switch","synchronized","this","throw","throws","true","transient","try","void","volatile","while"]})),b.add(new a.CN.Model.Language({name:"javafx",aliases:["jfx","javafx"]})),b.add(new a.CN.Model.Language({name:"js",aliases:["js","jscript","javascript","json"],keywords:["break","case","catch","class","continue","default","delete","do","else","enum","export","extends","false","for","function","if","implements","import","in","instanceof","interface","let","new","null","package","private","protected","static","return","super","switch","this","throw","true","try","typeof","var","while","with","yield"]})),b.add(new a.CN.Model.Language({name:"perl",aliases:["perl","pl"]})),b.add(new a.CN.Model.Language({name:"php",aliases:["php"]})),b.add(new a.CN.Model.Language({name:"plain",aliases:["text","plain"]})),b.add(new a.CN.Model.Language({name:"powershell",aliases:["powershell","ps","posh"]})),b.add(new a.CN.Model.Language({name:"python",aliases:["py","python"]})),b.add(new a.CN.Model.Language({name:"ruby",aliases:["ruby","rails","ror","rb"]})),b.add(new a.CN.Model.Language({name:"sass",aliases:["sass","scss"]})),b.add(new a.CN.Model.Language({name:"scala",aliases:["scala"]})),b.add(new a.CN.Model.Language({name:"sql",aliases:["sql"]})),b.add(new a.CN.Model.Language({name:"tap",aliases:["tap"]})),b.add(new a.CN.Model.Language({name:"typescript",aliases:["typescript","ts"]})),b.add(new a.CN.Model.Language({name:"vb",aliases:["vb","vbnet"]})),b.add(new a.CN.Model.Language({name:"xml",aliases:["xml","xhtml","xslt","html","plist"]})),b}}}})},"1.0",{requires:["base","array-extras","cn-languages"]}),YUI.add("cn-code-formatter",function(a){a.namespace("CN").CodeFormatter=a.Base.create("cn-code-formatter",a.Base,[],{process:function(){}},{})},"1.0",{requires:["base"]}),YUI.add("cn-highlighter",function(a){a.namespace("CN").Highlighter=a.Base.create("cn-highlighter",a.Base,[],{process:function(a){hljs.highlightBlock(a._node)}},{})},"1.0",{requires:["base"]}),YUI.add("cn-code-processor",function(a){a.namespace("CN").CodeProcessor=a.Base.create("cn-code-processor",a.Base,[],{processAll:function(a){var b=this;a&&a.each(function(a){b.processNode(a)})},processNode:function(b){var c=this.getCodeCleaner(),d=this.getLangDetector(),e=this.getCodeFormatter(),f=this.getHighlighter();a.Lang.isNull(b)||(d&&d.process(b),c&&c.process(b),e&&e.process(b),f&&f.process(b))},getCodeCleaner:function(){return this.get("codeCleaner")},getLangDetector:function(){return this.get("langDetector")},getCodeFormatter:function(){return this.get("codeFormatter")},getHighlighter:function(){return this.get("hightlighter")}},{ATTRS:{codeCleaner:{valueFn:function(){return new a.CN.CodeCleaner}},langDetector:{valueFn:function(){return new a.CN.LangDetector}},codeFormatter:{valueFn:function(){return new a.CN.CodeFormatter}},hightlighter:{valueFn:function(){return new a.CN.Highlighter}}}})},"1.0",{requires:["base","cn-code-cleaner","cn-lang-detector","cn-code-formatter","cn-highlighter"]}),YUI.add("cn-page-listener",function(a){var b=!1;a.namespace("CN.Cache").Node={},a.namespace("CN.Page").Listener=function(){var c=["init","onAuthorise"],d=new a.CN.CodeProcessor,e=new a.NodeList,f=(new a.NodeList,new a.CN.Popup({callback:function(){a.CN.Page.Listener.init()}})),g=function(){var b=a.all("pre");b.each(function(b){var c=b.cloneNode(!0),d=a.Node.create("<div></div>");b.replace(d),d.setHTML(c._node),a.CN.Cache.Node[d._yuid]=d.getHTML(),e.push(d)})},h=function(){if(b){var c=a.all(".cn-marked");c.each(function(b){b.removeAttribute("selected"),b.removeClass("cn-selected"),b.removeClass("cn-marked"),b.setHTML(a.CN.Cache.Node[b._yuid]),b.detach()}),f.reset(),f.hide()}else e.isEmpty()&&g(),e.each(function(b){b.addClass("cn-marked"),b.on("click",function(){var b;this.getAttribute("selected")?(this.removeClass("cn-selected"),this.removeAttribute("selected"),this.setHTML(a.CN.Cache.Node[this._yuid])):(b=this.one("pre"),this.addClass("cn-selected"),this.setAttribute("selected"),d.processNode(b))},b)}),f.show();b=!b},i=function(a){b&&f.initUI(a,e)};return{METHODS:c,init:h,onAuthorise:i}}()},"1.0",{requires:["node","cn-code-processor","cn-code-note-popup"]}),YUI({lang:"en"}).use("cn-page-listener",function(a){chrome.extension.onConnect.addListener(function(b){b.onMessage.addListener(function(b){b.method&&a.Lang.isString(b.method)&&a.CN.Page.Listener.METHODS.indexOf(b.method)>-1&&a.CN.Page.Listener[b.method](b.data)})})});